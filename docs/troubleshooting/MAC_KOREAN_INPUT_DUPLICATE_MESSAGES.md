# ë§¥ í•œê¸€ ì…ë ¥ ì¤‘ë³µ ë©”ì‹œì§€ ì „ì†¡ ë¬¸ì œ ë””ë²„ê¹… ë…¸íŠ¸

## ğŸ“‹ ë¬¸ì œ ìš”ì•½
**ë¬¸ì œ**: ë§¥ì—ì„œ í•œê¸€ë¡œ ì±„íŒ… ì…ë ¥ ì‹œ ë©”ì‹œì§€ê°€ ì¤‘ë³µìœ¼ë¡œ ì „ì†¡ë˜ëŠ” í˜„ìƒ
**ì˜í–¥ ë²”ìœ„**: ë§¥OS ì‚¬ìš©ìì˜ ì±„íŒ… ê¸°ëŠ¥
**ì‹¬ê°ë„**: Medium (ì‚¬ìš©ì ê²½í—˜ ì €í•˜)
**í•´ê²° ìƒíƒœ**: âœ… ì™„ë£Œ

---

## ğŸ” ë¬¸ì œ ë¶„ì„

### ì¦ìƒ
- ë§¥ì—ì„œ í•œê¸€ ì…ë ¥ í›„ Enter í‚¤ë¥¼ ëˆ„ë¥´ë©´ ë©”ì‹œì§€ê°€ 2ë²ˆ ì „ì†¡ë¨
- ì˜ë¬¸ ì…ë ¥ ì‹œì—ëŠ” ë¬¸ì œ ì—†ìŒ
- ë‹¤ë¥¸ ìš´ì˜ì²´ì œì—ì„œëŠ” ë¬¸ì œ ì—†ìŒ

### ê·¼ë³¸ ì›ì¸
1. **IME (Input Method Editor) ì²˜ë¦¬ ëˆ„ë½**
   - í•œê¸€ ì…ë ¥ ì‹œ `compositionstart`/`compositionend` ì´ë²¤íŠ¸ ë¯¸ì²˜ë¦¬
   - Enter í‚¤ê°€ í•œê¸€ ì¡°í•© ì™„ë£Œì™€ ë©”ì‹œì§€ ì „ì†¡ì„ ë™ì‹œì— íŠ¸ë¦¬ê±°

2. **ì´ë²¤íŠ¸ ì¤‘ë³µ ì²˜ë¦¬**
   - ê¸°ì¡´ ì½”ë“œì—ì„œ composition ìƒíƒœ í™•ì¸ ì—†ìŒ
   - ì§§ì€ ì‹œê°„ ë‚´ ì¤‘ë³µ ì´ë²¤íŠ¸ ë°©ì§€ ë¡œì§ ë¶€ì¬

### ê¸°ì¡´ ì½”ë“œ ë¬¸ì œì 
```javascript
// chat.js:37-42 (ìˆ˜ì • ì „)
document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey && e.target.classList.contains('message-textarea')) {
        e.preventDefault();
        this.sendMessage(); // IME ìƒíƒœ í™•ì¸ ì—†ì´ ë°”ë¡œ ì „ì†¡
    }
});
```

---

## ğŸ› ï¸ í•´ê²° ë°©ë²•

### 1. Composition ìƒíƒœ ì¶”ì 
```javascript
// ChatInterface ìƒì„±ìì— ìƒíƒœ ë³€ìˆ˜ ì¶”ê°€
constructor() {
    this.selectedRoomId = null;
    this.stompClient = null;
    this.currentUser = null;
    this.isComposing = false;      // IME ì…ë ¥ ìƒíƒœ
    this.lastSendTime = 0;         // ì¤‘ë³µ ë°©ì§€ìš© íƒ€ì„ìŠ¤íƒ¬í”„
    
    this.init();
}
```

### 2. IME ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
```javascript
// Composition ì´ë²¤íŠ¸ ì²˜ë¦¬
document.addEventListener('compositionstart', (e) => {
    if (e.target.classList.contains('message-textarea')) {
        this.isComposing = true;
    }
});

document.addEventListener('compositionend', (e) => {
    if (e.target.classList.contains('message-textarea')) {
        this.isComposing = false;
    }
});
```

### 3. Enter í‚¤ í•¸ë“¤ëŸ¬ ê°œì„ 
```javascript
// ê°œì„ ëœ Enter í‚¤ ì²˜ë¦¬
document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' && !e.shiftKey && e.target.classList.contains('message-textarea')) {
        // IME ì…ë ¥ ì¤‘ì¼ ë•ŒëŠ” ë©”ì‹œì§€ ì „ì†¡ ë°©ì§€
        if (!this.isComposing) {
            e.preventDefault();
            this.sendMessage();
        }
    }
});
```

### 4. ì¤‘ë³µ ì „ì†¡ ë°©ì§€ ë¡œì§
```javascript
async sendMessage() {
    const textarea = document.getElementById('messageInput');
    const message = textarea?.value.trim();
    
    if (!message || !this.selectedRoomId) {
        return;
    }
    
    // ë””ë°”ìš´ìŠ¤ ë¡œì§ - 500ms ë‚´ ì¤‘ë³µ ì „ì†¡ ë°©ì§€
    const now = Date.now();
    if (now - this.lastSendTime < 500) {
        console.log('Duplicate message send prevented (debounced)');
        return;
    }
    
    // ì¶”ê°€ ì•ˆì „ì¥ì¹˜ - composition ìƒíƒœ ì¬í™•ì¸
    if (this.isComposing) {
        console.log('Message send prevented: IME composition in progress');
        return;
    }
    
    this.lastSendTime = now;
    
    // ê¸°ì¡´ ì „ì†¡ ë¡œì§...
}
```

---

## ğŸ”§ ì ìš©ëœ ë³€ê²½ì‚¬í•­

### íŒŒì¼: `src/main/resources/static/js/chat.js`

#### 1. ìƒì„±ì ìˆ˜ì • (ë¼ì¸ 3-11)
- `isComposing` ìƒíƒœ í”Œë˜ê·¸ ì¶”ê°€
- `lastSendTime` ë””ë°”ìš´ìŠ¤ìš© íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€

#### 2. ì´ë²¤íŠ¸ ë°”ì¸ë”© ì¶”ê°€ (ë¼ì¸ 38-60)
- `compositionstart` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
- `compositionend` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬  
- ê¸°ì¡´ `keydown` í•¸ë“¤ëŸ¬ì— composition ìƒíƒœ ê²€ì‚¬ ì¶”ê°€

#### 3. sendMessage ë©”ì„œë“œ ê°œì„  (ë¼ì¸ 615-661)
- 500ms ë””ë°”ìš´ìŠ¤ ë¡œì§ ì¶”ê°€
- composition ìƒíƒœ ì¬í™•ì¸ ë¡œì§ ì¶”ê°€
- ë””ë²„ê¹…ì„ ìœ„í•œ ì½˜ì†” ë¡œê·¸ ì¶”ê°€

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ê¸°ë³¸ í…ŒìŠ¤íŠ¸
1. **í•œê¸€ ì…ë ¥ í…ŒìŠ¤íŠ¸**
   - í•œê¸€ë¡œ ë©”ì‹œì§€ ì…ë ¥ í›„ Enter â†’ 1ë²ˆë§Œ ì „ì†¡ë˜ì–´ì•¼ í•¨
   - í•œê¸€ ì¡°í•© ì¤‘ Enter í‚¤ ì…ë ¥ â†’ ë©”ì‹œì§€ ì „ì†¡ ì•ˆë¨

2. **ì˜ë¬¸ ì…ë ¥ í…ŒìŠ¤íŠ¸**  
   - ì˜ë¬¸ìœ¼ë¡œ ë©”ì‹œì§€ ì…ë ¥ í›„ Enter â†’ ì •ìƒ ì „ì†¡
   - ê¸°ì¡´ ê¸°ëŠ¥ì— ì˜í–¥ ì—†ìŒ í™•ì¸

3. **í˜¼í•© ì…ë ¥ í…ŒìŠ¤íŠ¸**
   - ì˜ë¬¸+í•œê¸€ í˜¼í•© ì…ë ¥ í›„ Enter â†’ 1ë²ˆë§Œ ì „ì†¡
   - íŠ¹ìˆ˜ë¬¸ì í¬í•¨ ì…ë ¥ í…ŒìŠ¤íŠ¸

### ê³ ê¸‰ í…ŒìŠ¤íŠ¸
1. **ë¹ ë¥¸ ì—°ì† ì…ë ¥ í…ŒìŠ¤íŠ¸**
   - ë¹ ë¥´ê²Œ ì—°ì†ìœ¼ë¡œ Enter ì…ë ¥ â†’ ë””ë°”ìš´ìŠ¤ë¡œ ë°©ì§€
   - 500ms ì´í›„ ì…ë ¥ â†’ ì •ìƒ ì „ì†¡

2. **ë‹¤ì–‘í•œ IME í…ŒìŠ¤íŠ¸**
   - í•œê¸€ ì™¸ ë‹¤ë¥¸ ì–¸ì–´ IME (ì¼ë³¸ì–´, ì¤‘êµ­ì–´ ë“±)
   - ë‹¤ì–‘í•œ í•œê¸€ ì…ë ¥ê¸° í…ŒìŠ¤íŠ¸

3. **ë¸Œë¼ìš°ì €ë³„ í˜¸í™˜ì„±**
   - Safari, Chrome, Firefoxì—ì„œ ë™ì¼í•˜ê²Œ ì‘ë™
   - ë§¥ ì™¸ ë‹¤ë¥¸ OSì—ì„œ ê¸°ì¡´ ë™ì‘ ìœ ì§€

---

## ğŸ“Š ì„±ëŠ¥ ì˜í–¥

### ì¶”ê°€ëœ ê¸°ëŠ¥
- **ë©”ëª¨ë¦¬**: ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ 2ê°œ ì¶”ê°€ (ë¬´ì‹œí•  ìˆ˜ì¤€)
- **ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ**: 2ê°œ ì¶”ê°€ (`compositionstart`, `compositionend`)
- **ì²˜ë¦¬ ì‹œê°„**: ê° ë©”ì‹œì§€ ì „ì†¡ ì‹œ ì¶”ê°€ ê²€ì‚¬ (<1ms)

### ìµœì í™” ê³ ë ¤ì‚¬í•­
- ë””ë°”ìš´ìŠ¤ ì‹œê°„ ì¡°ì • ê°€ëŠ¥ (í˜„ì¬ 500ms)
- í•„ìš”ì‹œ IME ì–¸ì–´ë³„ ì„¸ë¶€ ì¡°ì • ê°€ëŠ¥
- ì½˜ì†” ë¡œê·¸ëŠ” í”„ë¡œë•ì…˜ì—ì„œ ì œê±° ê°€ëŠ¥

---

## ğŸš€ ë°°í¬ ê°€ì´ë“œ

### ë°°í¬ ë°©ë²•
1. JavaScript íŒŒì¼ë§Œ ìˆ˜ì •ë˜ì–´ ì„œë²„ ì¬ì‹œì‘ ë¶ˆí•„ìš”
2. ë¸Œë¼ìš°ì € ìºì‹œ í´ë¦¬ì–´ í›„ ìƒˆë¡œê³ ì¹¨ìœ¼ë¡œ ì¦‰ì‹œ ì ìš©
3. CDN ì‚¬ìš© ì‹œ ìºì‹œ ë¬´íš¨í™” í•„ìš”

### ë¡¤ë°± ê³„íš
- ê¸°ì¡´ ì½”ë“œë¡œ ì‰½ê²Œ ë¡¤ë°± ê°€ëŠ¥
- git íˆìŠ¤í† ë¦¬ë¥¼ í†µí•œ ì¦‰ì‹œ ë³µêµ¬ ê°€ëŠ¥

### ëª¨ë‹ˆí„°ë§ í¬ì¸íŠ¸
- ì±„íŒ… ë©”ì‹œì§€ ì¤‘ë³µ ì „ì†¡ ì§€í‘œ ëª¨ë‹ˆí„°ë§
- ë§¥ ì‚¬ìš©ìì˜ ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µë¥  ì¶”ì 
- ë¸Œë¼ìš°ì €ë³„ ì˜¤ë¥˜ ë¡œê·¸ ëª¨ë‹ˆí„°ë§

---

## ğŸ¯ í–¥í›„ ê°œì„  ë°©í–¥

### ë‹¨ê¸° ê°œì„ ì‚¬í•­
- [ ] í”„ë¡œë•ì…˜ì—ì„œ ë””ë²„ê·¸ ë¡œê·¸ ì œê±°
- [ ] ë””ë°”ìš´ìŠ¤ ì‹œê°„ ì‚¬ìš©ì ì„¤ì • ê°€ëŠ¥í™”
- [ ] ë‹¤êµ­ì–´ IME ì§€ì› í™•ì¥

### ì¥ê¸° ê°œì„ ì‚¬í•­
- [ ] ì‹¤ì‹œê°„ íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„°ì™€ IME ìƒíƒœ ì—°ë™
- [ ] ëª¨ë°”ì¼ ë””ë°”ì´ìŠ¤ IME ì§€ì› ê°•í™”
- [ ] ì ‘ê·¼ì„± ê°œì„  (ìŠ¤í¬ë¦° ë¦¬ë” ë“±)

---

## ğŸ“š ê´€ë ¨ ë¦¬ì†ŒìŠ¤

### ê¸°ìˆ  ë¬¸ì„œ
- [MDN Composition Events](https://developer.mozilla.org/en-US/docs/Web/API/CompositionEvent)
- [IME ì²˜ë¦¬ Best Practices](https://www.w3.org/International/articles/ime/)

### í”„ë¡œì íŠ¸ ë‚´ ê´€ë ¨ íŒŒì¼
- `src/main/resources/static/js/chat.js` - ë©”ì¸ ìˆ˜ì • íŒŒì¼
- `docs/domains/chat/README.md` - ì±„íŒ… ë„ë©”ì¸ ë¬¸ì„œ
- `docs/domains/chat/CLAUDE.md` - ì±„íŒ… ê°œë°œ ê°€ì´ë“œ

### ì´ìŠˆ ì¶”ì 
- **í•´ê²° ì¼ì‹œ**: 2025-01-08
- **ë‹´ë‹¹ì**: Claude Code
- **ë¦¬ë·°ì–´**: N/A
- **í…ŒìŠ¤í„°**: í”„ë¡œë•ì…˜ ë°°í¬ í›„ ì‚¬ìš©ì í”¼ë“œë°± ëŒ€ê¸°

---

*ì´ ë¬¸ì„œëŠ” ë§¥ í•œê¸€ ì…ë ¥ ì¤‘ë³µ ë©”ì‹œì§€ ë¬¸ì œ í•´ê²° ê³¼ì •ì„ ê¸°ë¡í•˜ë©°, í–¥í›„ ìœ ì‚¬í•œ IME ê´€ë ¨ ì´ìŠˆ í•´ê²°ì— ì°¸ê³ ìë£Œë¡œ í™œìš©ë©ë‹ˆë‹¤.*