<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íšŒì›ê°€ì… - Topping</title>
    <link rel="stylesheet" th:href="@{/css/navbar.css}">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .main-content { display: flex; align-items: center; justify-content: center; min-height: calc(100vh - 70px); padding: 20px; }
        .signup-container { background: white; border-radius: 10px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); padding: 40px; width: 100%; max-width: 450px; }
        .logo { text-align: center; margin-bottom: 30px; }
        .logo h1 { color: #333; font-size: 32px; margin-bottom: 5px; }
        .logo p { color: #666; font-size: 14px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: #333; font-weight: bold; }
        .form-group input, .form-group select { width: 100%; padding: 12px 15px; border: 2px solid #e1e1e1; border-radius: 5px; font-size: 16px; transition: border-color 0.3s; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #667eea; }
        .form-group.valid input { border-color: #27ae60; }
        .form-group.invalid input { border-color: #e74c3c; }
        .btn { width: 100%; padding: 12px; background: #667eea; color: white; border: none; border-radius: 5px; font-size: 16px; font-weight: bold; cursor: pointer; transition: background 0.3s; }
        .btn:hover { background: #5a6fd8; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .error-message { color: #e74c3c; font-size: 14px; margin-top: 5px; display: none; }
        .success-message { color: #27ae60; font-size: 14px; margin-top: 5px; display: none; }
        .valid-message { color: #27ae60; font-size: 14px; margin-top: 5px; display: none; }
        .links { text-align: center; margin-top: 20px; }
        .links a { color: #667eea; text-decoration: none; font-size: 14px; }
        .links a:hover { text-decoration: underline; }
        .loading { display: none; text-align: center; margin-top: 10px; }
        .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .password-strength { margin-top: 5px; }
        .strength-bar { height: 4px; background: #e1e1e1; border-radius: 2px; overflow: hidden; }
        .strength-fill { height: 100%; transition: width 0.3s, background-color 0.3s; }
        .strength-weak { background: #e74c3c; }
        .strength-medium { background: #f39c12; }
        .strength-strong { background: #27ae60; }
        .strength-text { font-size: 12px; margin-top: 2px; }
        .checkbox-group { display: flex; align-items: flex-start; gap: 10px; }
        .checkbox-group input[type="checkbox"] { width: auto; margin-top: 3px; cursor: pointer; }
        .checkbox-label { flex: 1; font-size: 14px; line-height: 1.4; cursor: pointer; }
        .terms-link { color: #667eea; text-decoration: none; font-weight: bold; }
        .terms-link:hover { text-decoration: underline; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 20px; border: none; border-radius: 10px; width: 80%; max-width: 600px; max-height: 80vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-title { font-size: 20px; font-weight: bold; color: #333; }
        .close { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover, .close:focus { color: #000; text-decoration: none; }
        .modal-body { line-height: 1.6; color: #333; }
        .modal-body h3 { margin-top: 20px; margin-bottom: 10px; color: #667eea; }
        .modal-body p { margin-bottom: 10px; }
        .modal-body ul { margin-bottom: 10px; padding-left: 20px; }
    </style>
</head>
<body>
    <!-- Include Navigation Bar -->
    <div th:replace="fragments/navbar :: navbar"></div>
    
    <div class="main-content">
        <div class="signup-container">
        <div class="logo">
            <h1>ğŸ• Topping</h1>
            <p>Collabo í”Œë«í¼ì— ê°€ì…í•˜ì„¸ìš”</p>
        </div>

        <form id="signupForm" onsubmit="handleSignup(event)">
            <div class="form-group">
                <label for="name">ì´ë¦„</label>
                <input type="text" id="name" name="name" required placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" 
                       oninput="validateName()">
                <div class="error-message" id="nameError"></div>
                <div class="valid-message" id="nameValid"></div>
            </div>

            <div class="form-group">
                <label for="email">ì´ë©”ì¼</label>
                <input type="email" id="email" name="email" required placeholder="your@email.com" 
                       oninput="validateEmail()">
                <div class="error-message" id="emailError"></div>
                <div class="valid-message" id="emailValid"></div>
            </div>

            <div class="form-group">
                <label for="role">ì—­í• </label>
                <select id="role" name="role" required>
                    <option value="">ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ROLE_USER">ì¼ë°˜ ì‚¬ìš©ì</option>
                    <option value="ROLE_BUSINESS_OWNER">ë¹„ì¦ˆë‹ˆìŠ¤ ì˜¤ë„ˆ</option>
                </select>
                <div class="error-message" id="roleError"></div>
            </div>

            <div class="form-group">
                <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="password" name="password" required 
                       placeholder="6ì ì´ìƒì˜ ë¹„ë°€ë²ˆí˜¸" oninput="validatePassword()">
                <div class="password-strength" id="passwordStrength" style="display: none;">
                    <div class="strength-bar">
                        <div class="strength-fill" id="strengthFill"></div>
                    </div>
                    <div class="strength-text" id="strengthText"></div>
                </div>
                <div class="error-message" id="passwordError"></div>
                <div class="valid-message" id="passwordValid"></div>
            </div>

            <div class="form-group">
                <label for="confirmPassword">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input type="password" id="confirmPassword" name="confirmPassword" required 
                       placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”" oninput="validateConfirmPassword()">
                <div class="error-message" id="confirmPasswordError"></div>
                <div class="valid-message" id="confirmPasswordValid"></div>
            </div>

            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="termsAgreement" name="termsAgreement" required>
                    <label for="termsAgreement" class="checkbox-label">
                        <a href="#" onclick="openTermsModal()" class="terms-link">ì´ìš©ì•½ê´€</a> ë° 
                        <a href="#" onclick="openPrivacyModal()" class="terms-link">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>ì— ë™ì˜í•©ë‹ˆë‹¤.
                    </label>
                </div>
                <div class="error-message" id="termsError"></div>
            </div>

            <button type="submit" class="btn" id="signupBtn">
                íšŒì›ê°€ì…
            </button>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <span>ê°€ì… ì²˜ë¦¬ ì¤‘...</span>
            </div>

            <div class="error-message" id="generalError"></div>
            <div class="success-message" id="successMessage"></div>
        </form>

        <div class="links">
            <a href="/auth/login">ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? ë¡œê·¸ì¸</a>
        </div>
    </div>

    <!-- Terms of Service Modal -->
    <div id="termsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ì´ìš©ì•½ê´€</h2>
                <span class="close" onclick="closeTermsModal()">&times;</span>
            </div>
            <div class="modal-body">
                <h3>ì œ1ì¡° (ëª©ì )</h3>
                <p>ì´ ì•½ê´€ì€ í† í•‘(Topping) í”Œë«í¼(ì´í•˜ "ì„œë¹„ìŠ¤"ë¼ í•¨)ì˜ ì´ìš©ì¡°ê±´ ë° ì ˆì°¨, íšŒì‚¬ì™€ ì´ìš©ì ê°„ì˜ ê¶Œë¦¬, ì˜ë¬´ ë° ì±…ì„ì‚¬í•­ì„ ê·œì •í•¨ì„ ëª©ì ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
                
                <h3>ì œ2ì¡° (ì •ì˜)</h3>
                <p>ì´ ì•½ê´€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ìš©ì–´ì˜ ì •ì˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
                <ul>
                    <li>"ì„œë¹„ìŠ¤"ë¼ í•¨ì€ í† í•‘ í”Œë«í¼ì—ì„œ ì œê³µí•˜ëŠ” ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
                    <li>"íšŒì›"ì´ë¼ í•¨ì€ ì„œë¹„ìŠ¤ì— ê°œì¸ì •ë³´ë¥¼ ì œê³µí•˜ì—¬ íšŒì›ë“±ë¡ì„ í•œ ìë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
                    <li>"ì½˜í…ì¸ "ë¼ í•¨ì€ ì„œë¹„ìŠ¤ì—ì„œ ì œê³µë˜ëŠ” ëª¨ë“  ì •ë³´, ë°ì´í„°, ë¬¸ì„œ, ì´ë¯¸ì§€ ë“±ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
                </ul>
                
                <h3>ì œ3ì¡° (ì•½ê´€ì˜ íš¨ë ¥ ë° ë³€ê²½)</h3>
                <p>ì´ ì•½ê´€ì€ ì„œë¹„ìŠ¤ í™”ë©´ì— ê²Œì‹œí•˜ì—¬ ê³µì‹œí•¨ìœ¼ë¡œì¨ íš¨ë ¥ì´ ë°œìƒí•©ë‹ˆë‹¤. íšŒì‚¬ëŠ” í•©ë¦¬ì ì¸ ì‚¬ìœ ê°€ ë°œìƒí•  ê²½ìš° ì´ ì•½ê´€ì„ ë³€ê²½í•  ìˆ˜ ìˆìœ¼ë©°, ë³€ê²½ëœ ì•½ê´€ì€ ì„œë¹„ìŠ¤ í™”ë©´ì— ê³µì§€í•¨ìœ¼ë¡œì¨ íš¨ë ¥ì´ ë°œìƒí•©ë‹ˆë‹¤.</p>
                
                <h3>ì œ4ì¡° (ì„œë¹„ìŠ¤ì˜ ì œê³µ)</h3>
                <p>íšŒì‚¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤:</p>
                <ul>
                    <li>ë¹„ì¦ˆë‹ˆìŠ¤ í˜‘ì—… ë§¤ì¹­ ì„œë¹„ìŠ¤</li>
                    <li>ìƒí’ˆ ë° ì„œë¹„ìŠ¤ ë“±ë¡ ë° ê´€ë¦¬</li>
                    <li>í˜‘ì—… ì œì•ˆ ë° ì†Œí†µ ê¸°ëŠ¥</li>
                    <li>ê¸°íƒ€ íšŒì‚¬ê°€ ì •í•˜ëŠ” ì„œë¹„ìŠ¤</li>
                </ul>
                
                <h3>ì œ5ì¡° (íšŒì›ì˜ ì˜ë¬´)</h3>
                <p>íšŒì›ì€ ë‹¤ìŒ í–‰ìœ„ë¥¼ í•˜ì—¬ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤:</p>
                <ul>
                    <li>í—ˆìœ„ ì •ë³´ ì…ë ¥</li>
                    <li>íƒ€ì¸ì˜ ì •ë³´ ë„ìš©</li>
                    <li>ì„œë¹„ìŠ¤ ìš´ì˜ì— ë°©í•´ë˜ëŠ” í–‰ìœ„</li>
                    <li>ë²•ë ¹ì— ìœ„ë°˜ë˜ëŠ” í–‰ìœ„</li>
                </ul>
                
                <h3>ì œ6ì¡° (ê°œì¸ì •ë³´ë³´í˜¸)</h3>
                <p>íšŒì‚¬ëŠ” ê´€ë ¨ ë²•ë ¹ì´ ì •í•˜ëŠ” ë°”ì— ë”°ë¼ íšŒì›ì˜ ê°œì¸ì •ë³´ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ ë…¸ë ¥í•©ë‹ˆë‹¤. ê°œì¸ì •ë³´ì˜ ë³´í˜¸ ë° ì‚¬ìš©ì— ëŒ€í•´ì„œëŠ” ê´€ë ¨ ë²•ë ¹ ë° ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ì„ ë”°ë¦…ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</h2>
                <span class="close" onclick="closePrivacyModal()">&times;</span>
            </div>
            <div class="modal-body">
                <h3>1. ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘ ë° ì´ìš©ëª©ì </h3>
                <p>í† í•‘ í”Œë«í¼ì€ ë‹¤ìŒì˜ ëª©ì ì„ ìœ„í•˜ì—¬ ê°œì¸ì •ë³´ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤:</p>
                <ul>
                    <li>íšŒì› ê°€ì… ë° ê´€ë¦¬</li>
                    <li>ì„œë¹„ìŠ¤ ì œê³µ ë° ì—…ë¬´ì²˜ë¦¬</li>
                    <li>ë§ˆì¼€íŒ… ë° ê´‘ê³ ì—ì˜ í™œìš©</li>
                    <li>ì„œë¹„ìŠ¤ ê°œì„  ë° ì‹ ê·œ ì„œë¹„ìŠ¤ ê°œë°œ</li>
                </ul>
                
                <h3>2. ì²˜ë¦¬í•˜ëŠ” ê°œì¸ì •ë³´ í•­ëª©</h3>
                <p>í† í•‘ í”Œë«í¼ì€ ë‹¤ìŒì˜ ê°œì¸ì •ë³´ í•­ëª©ì„ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤:</p>
                <ul>
                    <li>í•„ìˆ˜í•­ëª©: ì´ë¦„, ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸, ì—­í• </li>
                    <li>ì„ íƒí•­ëª©: í”„ë¡œí•„ ì‚¬ì§„, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ</li>
                    <li>ìë™ìˆ˜ì§‘í•­ëª©: ì ‘ì† IP, ì ‘ì† ë¡œê·¸, ì¿ í‚¤</li>
                </ul>
                
                <h3>3. ê°œì¸ì •ë³´ì˜ ì²˜ë¦¬ ë° ë³´ìœ ê¸°ê°„</h3>
                <p>ê°œì¸ì •ë³´ëŠ” ë²•ë ¹ì— ë”°ë¥¸ ê°œì¸ì •ë³´ ë³´ìœ Â·ì´ìš©ê¸°ê°„ ë˜ëŠ” ì •ë³´ì£¼ì²´ë¡œë¶€í„° ê°œì¸ì •ë³´ë¥¼ ìˆ˜ì§‘ ì‹œì— ë™ì˜ë°›ì€ ê°œì¸ì •ë³´ ë³´ìœ Â·ì´ìš©ê¸°ê°„ ë‚´ì—ì„œ ì²˜ë¦¬Â·ë³´ìœ í•©ë‹ˆë‹¤.</p>
                
                <h3>4. ê°œì¸ì •ë³´ì˜ ì œ3ì ì œê³µ</h3>
                <p>í† í•‘ í”Œë«í¼ì€ ì›ì¹™ì ìœ¼ë¡œ ì •ë³´ì£¼ì²´ì˜ ê°œì¸ì •ë³´ë¥¼ ì œ3ìì—ê²Œ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ë‹¤ìŒì˜ ê²½ìš°ì—ëŠ” ì˜ˆì™¸ë¡œ í•©ë‹ˆë‹¤:</p>
                <ul>
                    <li>ì •ë³´ì£¼ì²´ê°€ ì‚¬ì „ì— ë™ì˜í•œ ê²½ìš°</li>
                    <li>ë²•ë ¹ì˜ ê·œì •ì— ì˜í•˜ê±°ë‚˜, ìˆ˜ì‚¬ ëª©ì ìœ¼ë¡œ ë²•ë ¹ì— ì •í•´ì§„ ì ˆì°¨ì™€ ë°©ë²•ì— ë”°ë¼ ìˆ˜ì‚¬ê¸°ê´€ì˜ ìš”êµ¬ê°€ ìˆëŠ” ê²½ìš°</li>
                </ul>
                
                <h3>5. ê°œì¸ì •ë³´ ë³´í˜¸ì±…ì„ì</h3>
                <p>í† í•‘ í”Œë«í¼ì€ ê°œì¸ì •ë³´ ì²˜ë¦¬ì— ê´€í•œ ì—…ë¬´ë¥¼ ì´ê´„í•´ì„œ ì±…ì„ì§€ê³ , ê°œì¸ì •ë³´ ì²˜ë¦¬ì™€ ê´€ë ¨í•œ ì •ë³´ì£¼ì²´ì˜ ë¶ˆë§Œì²˜ë¦¬ ë° í”¼í•´êµ¬ì œ ë“±ì„ ìœ„í•˜ì—¬ ê°œì¸ì •ë³´ ë³´í˜¸ì±…ì„ìë¥¼ ì§€ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                
                <h3>6. ì •ë³´ì£¼ì²´ì˜ ê¶Œë¦¬Â·ì˜ë¬´ ë° ê·¸ í–‰ì‚¬ë°©ë²•</h3>
                <p>ì •ë³´ì£¼ì²´ëŠ” ì–¸ì œë“ ì§€ ê°œì¸ì •ë³´ ì—´ëŒÂ·ì •ì •Â·ì‚­ì œÂ·ì²˜ë¦¬ì •ì§€ ìš”êµ¬ ë“±ì˜ ê¶Œë¦¬ë¥¼ í–‰ì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <script>
        // Check if user is already logged in
        if (localStorage.getItem('accessToken')) {
            window.location.href = '/mypage';
        }

        let validation = {
            name: false,
            email: false,
            password: false,
            confirmPassword: false,
            terms: false
        };

        async function handleSignup(event) {
            event.preventDefault();
            
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                role: document.getElementById('role').value,
                password: document.getElementById('password').value,
                confirmPassword: document.getElementById('confirmPassword').value,
                termsAgreement: document.getElementById('termsAgreement').checked
            };
            
            const signupBtn = document.getElementById('signupBtn');
            const loading = document.getElementById('loading');
            
            // Clear previous errors
            clearErrors();
            
            // Validate all fields
            if (!validateAllFields(formData)) {
                return;
            }
            
            // Show loading state
            signupBtn.disabled = true;
            loading.style.display = 'block';
            
            try {
                const response = await fetch('/api/member/signup', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        username: formData.name,
                        email: formData.email,
                        password: formData.password,
                        role: formData.role,
                        termsAgreement: formData.termsAgreement
                    })
                });
                
                const data = await response.json();
                
                if (response.ok && data.code === 200) {
                    // Show success message
                    showSuccess('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤...');
                    
                    // Redirect to login after short delay
                    setTimeout(() => {
                        window.location.href = `/auth/login?email=${encodeURIComponent(formData.email)}`;
                    }, 2000);
                    
                } else {
                    // Handle signup failure
                    const errorMessage = data.message || 'íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                    showError('generalError', errorMessage);
                }
                
            } catch (error) {
                console.error('Signup error:', error);
                showError('generalError', 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            } finally {
                // Hide loading state
                signupBtn.disabled = false;
                loading.style.display = 'none';
            }
        }
        
        function validateAllFields(formData) {
            let isValid = true;
            
            if (!formData.name.trim()) {
                showError('nameError', 'ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                isValid = false;
            }
            
            if (!validateEmailFormat(formData.email)) {
                showError('emailError', 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                isValid = false;
            }
            
            if (!formData.role) {
                showError('roleError', 'ì—­í• ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                isValid = false;
            }
            
            if (formData.password.length < 6) {
                showError('passwordError', 'ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
                isValid = false;
            }
            
            if (formData.password !== formData.confirmPassword) {
                showError('confirmPasswordError', 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                isValid = false;
            }
            
            if (!formData.termsAgreement) {
                showError('termsError', 'ì´ìš©ì•½ê´€ ë° ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
                isValid = false;
            }
            
            return isValid;
        }
        
        function validateName() {
            const name = document.getElementById('name').value.trim();
            const nameGroup = document.getElementById('name').parentElement;
            
            if (name.length >= 2) {
                nameGroup.classList.remove('invalid');
                nameGroup.classList.add('valid');
                showValid('nameValid', 'âœ“ ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë¦„ì…ë‹ˆë‹¤.');
                hideError('nameError');
                validation.name = true;
            } else if (name.length > 0) {
                nameGroup.classList.remove('valid');
                nameGroup.classList.add('invalid');
                showError('nameError', 'ì´ë¦„ì€ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
                hideValid('nameValid');
                validation.name = false;
            } else {
                nameGroup.classList.remove('valid', 'invalid');
                hideError('nameError');
                hideValid('nameValid');
                validation.name = false;
            }
        }
        
        function validateEmail() {
            const email = document.getElementById('email').value;
            const emailGroup = document.getElementById('email').parentElement;
            
            if (validateEmailFormat(email)) {
                emailGroup.classList.remove('invalid');
                emailGroup.classList.add('valid');
                showValid('emailValid', 'âœ“ ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì…ë‹ˆë‹¤.');
                hideError('emailError');
                validation.email = true;
            } else if (email.length > 0) {
                emailGroup.classList.remove('valid');
                emailGroup.classList.add('invalid');
                showError('emailError', 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                hideValid('emailValid');
                validation.email = false;
            } else {
                emailGroup.classList.remove('valid', 'invalid');
                hideError('emailError');
                hideValid('emailValid');
                validation.email = false;
            }
        }
        
        function validatePassword() {
            const password = document.getElementById('password').value;
            const passwordGroup = document.getElementById('password').parentElement;
            const strengthIndicator = document.getElementById('passwordStrength');
            const strengthFill = document.getElementById('strengthFill');
            const strengthText = document.getElementById('strengthText');
            
            if (password.length > 0) {
                strengthIndicator.style.display = 'block';
                
                const strength = calculatePasswordStrength(password);
                
                if (strength.score >= 3) {
                    passwordGroup.classList.remove('invalid');
                    passwordGroup.classList.add('valid');
                    showValid('passwordValid', 'âœ“ ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.');
                    hideError('passwordError');
                    validation.password = true;
                } else if (password.length >= 6) {
                    passwordGroup.classList.remove('invalid', 'valid');
                    hideError('passwordError');
                    hideValid('passwordValid');
                    validation.password = true;
                } else {
                    passwordGroup.classList.remove('valid');
                    passwordGroup.classList.add('invalid');
                    showError('passwordError', 'ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
                    hideValid('passwordValid');
                    validation.password = false;
                }
                
                // Update strength indicator
                strengthFill.style.width = (strength.score * 25) + '%';
                strengthFill.className = 'strength-fill ' + strength.className;
                strengthText.textContent = strength.text;
                
            } else {
                strengthIndicator.style.display = 'none';
                passwordGroup.classList.remove('valid', 'invalid');
                hideError('passwordError');
                hideValid('passwordValid');
                validation.password = false;
            }
            
            // Re-validate confirm password if it has content
            if (document.getElementById('confirmPassword').value) {
                validateConfirmPassword();
            }
        }
        
        function validateConfirmPassword() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const confirmGroup = document.getElementById('confirmPassword').parentElement;
            
            if (confirmPassword.length > 0) {
                if (password === confirmPassword && password.length >= 6) {
                    confirmGroup.classList.remove('invalid');
                    confirmGroup.classList.add('valid');
                    showValid('confirmPasswordValid', 'âœ“ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.');
                    hideError('confirmPasswordError');
                    validation.confirmPassword = true;
                } else {
                    confirmGroup.classList.remove('valid');
                    confirmGroup.classList.add('invalid');
                    showError('confirmPasswordError', 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    hideValid('confirmPasswordValid');
                    validation.confirmPassword = false;
                }
            } else {
                confirmGroup.classList.remove('valid', 'invalid');
                hideError('confirmPasswordError');
                hideValid('confirmPasswordValid');
                validation.confirmPassword = false;
            }
        }
        
        function calculatePasswordStrength(password) {
            let score = 0;
            
            if (password.length >= 8) score++;
            if (/[a-z]/.test(password)) score++;
            if (/[A-Z]/.test(password)) score++;
            if (/[0-9]/.test(password)) score++;
            if (/[^A-Za-z0-9]/.test(password)) score++;
            
            const strengths = [
                { score: 0, text: 'ë§¤ìš° ì•½í•¨', className: 'strength-weak' },
                { score: 1, text: 'ì•½í•¨', className: 'strength-weak' },
                { score: 2, text: 'ë³´í†µ', className: 'strength-medium' },
                { score: 3, text: 'ê°•í•¨', className: 'strength-medium' },
                { score: 4, text: 'ë§¤ìš° ê°•í•¨', className: 'strength-strong' }
            ];
            
            return strengths[Math.min(score, 4)];
        }
        
        function validateEmailFormat(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
        
        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }
        
        function hideError(elementId) {
            const errorElement = document.getElementById(elementId);
            errorElement.style.display = 'none';
        }
        
        function showValid(elementId, message) {
            const validElement = document.getElementById(elementId);
            validElement.textContent = message;
            validElement.style.display = 'block';
        }
        
        function hideValid(elementId) {
            const validElement = document.getElementById(elementId);
            validElement.style.display = 'none';
        }
        
        function showSuccess(message) {
            const successElement = document.getElementById('successMessage');
            successElement.textContent = message;
            successElement.style.display = 'block';
        }
        
        function clearErrors() {
            const errorElements = document.querySelectorAll('.error-message, .success-message');
            errorElements.forEach(element => {
                element.style.display = 'none';
                element.textContent = '';
            });
        }
        
        // Modal functions
        function openTermsModal() {
            document.getElementById('termsModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        function closeTermsModal() {
            document.getElementById('termsModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function openPrivacyModal() {
            document.getElementById('privacyModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        function closePrivacyModal() {
            document.getElementById('privacyModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const termsModal = document.getElementById('termsModal');
            const privacyModal = document.getElementById('privacyModal');
            
            if (event.target === termsModal) {
                closeTermsModal();
            }
            if (event.target === privacyModal) {
                closePrivacyModal();
            }
        }
        
        // Terms agreement validation
        function validateTermsAgreement() {
            const termsCheckbox = document.getElementById('termsAgreement');
            const isChecked = termsCheckbox.checked;
            
            if (isChecked) {
                hideError('termsError');
                validation.terms = true;
            } else {
                validation.terms = false;
            }
        }
        
        // Add event listener for terms checkbox
        document.getElementById('termsAgreement').addEventListener('change', validateTermsAgreement);
    </script>
    </div>
</body>
</html>