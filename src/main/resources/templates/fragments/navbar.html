<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <!-- icon-->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
          rel="stylesheet"/>
    <style>
        .material-symbols-outlined {
            font-family: 'Material Symbols Outlined';
            font-weight: 400;
            font-style: normal;
            font-size: 24px;
            display: inline-block;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            white-space: nowrap;
            direction: ltr;
            -webkit-font-feature-settings: 'liga';
            -webkit-font-smoothing: antialiased;
            font-variation-settings: 'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24;
        }
    </style>
</head>
<body>
<!-- Sidebar Navigation Fragment -->
<div th:fragment="navbar">
    <!-- Mobile Menu Toggle Button -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle" onclick="toggleSidebar()">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
    </button>

    <!-- Sidebar Overlay for mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Main Sidebar -->
    <nav class="sidebar" id="sidebar">
        <!-- Logo Section -->
        <div class="sidebar-logo">
            <a href="/" class="logo-link">
                <img th:src="@{/image/topping_S.png}" alt="토핑" class="logo-image">
                <!--                <span class="logo-text">토핑</span>-->
            </a>
        </div>

        <!-- Navigation Menu -->
        <div class="sidebar-menu">
            <ul class="menu-list">
                <li class="menu-item">
                    <a href="/" class="home-link"
                       th:classappend="${#httpServletRequest != null and #httpServletRequest.requestURI.startsWith('/') ? 'active' : ''}">
                        <span class="material-symbols-outlined">home</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="/explore" class="menu-link"
                       th:classappend="${#httpServletRequest != null and #httpServletRequest.requestURI.startsWith('/explore') ? 'active' : ''}">
                        <span class="material-symbols-outlined">handshake</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="/mypage" class="menu-link"
                       th:classappend="${#httpServletRequest != null and #httpServletRequest.requestURI.startsWith('/mypage') ? 'active' : ''}">
                        <span class="material-symbols-outlined">person</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="/signup/step/1" class="menu-link"
                       th:classappend="${#httpServletRequest != null and #httpServletRequest.requestURI.startsWith('/signup') ? 'active' : ''}">
                        <span class="material-symbols-outlined">person_add</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Authentication Section -->
        <div class="sidebar-auth">
            <!-- Show login/signup for unauthenticated users -->
            <th:block sec:authorize="!isAuthenticated()">
                <a href="/auth/login" class="auth-link login-link"
                   th:classappend="${#httpServletRequest != null and #httpServletRequest.requestURI.startsWith('/auth/login') ? 'active' : ''}">
                    <i class="auth-icon">🔑</i>
                    <span class="auth-text">로그인</span>
                </a>
                <a href="/auth/signup" class="auth-link signup-link"
                   th:classappend="${#httpServletRequest != null and #httpServletRequest.requestURI.startsWith('/auth/signup') ? 'active' : ''}">
                    <i class="auth-icon">📝</i>
                    <span class="auth-text">회원가입</span>
                </a>
            </th:block>

            <!-- Show logout for authenticated users -->
            <th:block sec:authorize="isAuthenticated()">
                <a href="/logout" class="auth-link logout-link"
                   onclick="event.preventDefault(); document.getElementById('logout-form').submit();">
                    <i class="auth-icon">🚪</i>
                    <span class="auth-text">로그아웃</span>
                </a>

                <!-- Hidden logout form -->
                <form id="logout-form" action="/logout" method="post" style="display: none;">
                </form>
            </th:block>
        </div>
    </nav>
</div>
</body>
</html>